# 🚩 Next.js 14 버전 공부기록

## CSR (Client-Side Rendering)

- 모든 렌더링, 즉 모든 UI 구축 작업이 클라이언트 측에서 일어나는 것
- [Client] JS 로드 후 [JS] UI 빌드

### 페이지 이동 시 동작

1. Next.js는 서버에서 애플리케이션을 렌더링
2. Next.js는 모든 컴포넌트를 렌더링하여 해당 HTML을 브라우저 요청에 대한 응답으로 제공
3. 페이지 이동 시에도 빈 HTML이 아닌 서버에서 생성한 HTML을 보게 됨

### 장점

- JS 없어도 화면을 볼 수 있음 (HTML이기 때문에 사용자가 빈 화면을 보지 않음)
- 최초 애플리케이션 UI 빌드에서는 JS에 의존하지 않음
- 사용자가 페이지에 도착했을 때, UI를 빌드하는 데 JS가 필요하지 않음
- JS가 비활성화된 경우에도 화면을 볼 수 있음

### 결론

Next.js로 빌드된 페이지에 접속하면 Next.js가 그 페이지와 컴포넌트들을 기본적으로 서버에서 렌더링함

## Hydration

- 단순 HTML을 React 애플리케이션으로 초기화하는 작업
- 예를 들어, `/about-us` 페이지에 접속하면 HTML과 버튼이 로드되지만, JS가 로드되지 않아서 작동하지 않음
- 사용자는 화면에 로딩으로 보이지 않아서 잘 모름
- 빠르게 JS를 로드하여 사용자가 버튼을 클릭할 때 끊김 없이 작동하는 것처럼 보임
- 서버에서 모든 페이지와 컴포넌트를 렌더링하고 초기 상태에서 렌더링
- 이를 HTML로 만들어서 전달해주면 초기 화면을 보여주고, 뒷단에서 프레임워크가 초기화
- 초기 HTML에 React 애플리케이션을 생성

## "use client"란?

- 오직 클라이언트에서만 렌더링된다는 것이 아님
- 서버에서 렌더링되고 클라이언트에서 Hydrate된다는 것을 의미

### 동작 방식

1. 모든 것이 SSR로 렌더링됨
2. Pre-render되어 HTML로 변환
3. HTML이 사용자에게 전달되고, 그 후에 클라이언트 컴포넌트만이 Hydrate되고 인터랙티브하게 보여짐
4. "use client"가 없는 페이지는 서버에서만 렌더링되기 때문에 클라이언트에게 노출될 걱정이 없음 (API Key 같은)

## Route Group

- Route Group은 폴더 이름을 괄호로 묶어주어야 함
- 예: `(main)` 폴더는 URL을 생성하지 않음 —— Route Group!

## SSR VS CSR

### CSR로 데이터 Fetch

#### CSR 단점

- 로딩 상태를 직접 구현해야 함
- 항상 `useState`를 사용해야 함 (처음에는 컴포넌트가 비어있기 때문)
  ```jsx
  const [movies, setMovies] = useState([]);
  ```
- 수동으로 setMovie를 해줘야 함 (이는 렌더를 발생시키고 스스로 해줘야 함)

### Server Components에서 Fetch

- `useEffect`, `useState`를 사용하지 않아도 됨
- 로딩 상태 구현을 하지 않아도 됨

### 데이터 Fetch 시간이 오래 걸릴 경우

- `Suspense`를 사용하여 여러 데이터를 각 컴포넌트에서 호출하여 완료되는 데이터부터 보여줄 수 있음
- 여러 데이터를 다 가져온 후에 보여주는 것이 아닌, 따로 구분하여 Fetching 완료된 데이터부터 띄워줌
